<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Visualizador de Planilha - Debug</title>
    <style>
        /* Estilos anteriores... */
        #debug-panel {
            margin-top: 30px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 5px;
            font-family: monospace;
        }
        .debug-log {
            white-space: pre-wrap;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <!-- Conteúdo anterior... -->
    
    <div id="debug-panel">
        <h3>Painel de Diagnóstico</h3>
        <div id="debug-log"></div>
    </div>

    <script>
        // Função para logar eventos
        function debugLog(message) {
            const now = new Date().toISOString().split('T')[1].split('.')[0];
            const logElement = document.createElement('div');
            logElement.className = 'debug-log';
            logElement.textContent = `[${now}] ${message}`;
            document.getElementById('debug-log').prepend(logElement);
            console.log(message);
        }

        // Função loadSheetData atualizada
        async function loadSheetData() {
            try {
                debugLog('Iniciando carregamento...');
                
                const testConnection = await fetch('https://www.google.com');
                if (!testConnection.ok) {
                    throw new Error('Sem conexão com a internet');
                }
                debugLog('Conexão com internet OK');

                const apiTest = await fetch(SCRIPT_URL);
                if (!apiTest.ok) {
                    throw new Error('API não respondeu corretamente');
                }
                debugLog('API respondeu com status: ' + apiTest.status);

                // Restante do código...
                
            } catch (error) {
                debugLog('ERRO: ' + error.message);
                // Tratamento de erro...
            }
        }

        // Iniciar automaticamente
        window.addEventListener('DOMContentLoaded', () => {
            debugLog('Página carregada - iniciando processo');
            loadSheetData();
        });
    </script>
</body>
</html>
